# Governance AGENT

目标
- 建立统一语言、显性约束、关键决策与主要风险的“最小可读集”，支撑战略/战术/交付层的讨论与落地。
- 以文件为单位：先整文件初稿，再逐条修订；必要时按主题拆分文件。

文件清单
- glossary.md：统一术语表（卡片列表）
- constraints.md：显著约束清单（卡片列表）
- decisions.md：关键决策（简条列表）
- risks.md：主要风险（卡片列表）

文件级结果契约与节奏
- glossary.md
  - 结构：卡片列表；每条严格包含“术语、定义、正例、反例、易混词”，≤6行/条。
  - 节奏：首轮生成6–10条初稿；迭代阶段逐条修订或新增；修订时仅输出该条目。
  - 拆分：当术语跨多个子域或>100行时，拆分为 glossary-<context>.md。
- constraints.md
  - 结构：每条=名称(含类别标签：安全/合规/技术/组织)/简述/可能影响（指向具体文件或环节）。
  - 节奏：首轮生成4–8条初稿；迭代阶段逐条修订；修订仅输出该条。
  - 拆分：按领域或风险类型拆分，如 constraints-security.md。
- decisions.md
  - 结构：每条=日期/问题/选项/结论/理由/影响（指向用例/事件/契约/场景的具体文件位置）。
  - 节奏：首轮生成2–4条当前关键决策；后续新增/修订单条；每条≤10行。
  - 拆分：通常不需要；历史过多时可归档 decisions-archive.md。
- risks.md
  - 结构：每条=标题/概率/影响/缓解/触发条件（可观测事件或阈值）。
  - 节奏：首轮生成3–5条；后续逐条增修；每条≤8行。
  - 拆分：可按运行域或阶段拆分，如 risks-ops.md、risks-release.md。

抽象验收性质（治理层）
- 一致性：术语与后续文档用语一致；决策/约束/风险引用术语时不多义。
- 完备性（相对当前目标）：首轮至少包含 术语≥6、约束≥4、决策≥2、风险≥3。
- 可证伪性：每条决策至少给出一个替代方案；风险包含可触发条件；约束标注具体影响落点。
- 可操作性：决策与约束的“影响”能追溯到具体文件或章节（如 2-tactical/.../use-cases.md 的某用例；4-delivery/contracts.md 的某接口版本块）。

对话节奏（内嵌规则）
- 初稿阶段：对每个文件单独发起“整文件初稿”生成；输出仅该文件内容及其“## 变更”首条“v1.0 首版”。
- 修订阶段：复制目标条目到对话中，发起“逐条修订”请求；输出仅该条的新版本。
- 扩展阶段：当文件触发拆分条件时，执行“拆分策略”，新建同构文件并迁移条目；原文件放“参见”占位。

文件顶端契约（建议粘贴到每个文件开头，便于AI直观遵守）
- glossary.md（注释示例）
  - 本文件为条目列表：每条=术语/定义/正例/反例/易混词，≤6行/条。
  - 节奏：先整文件初稿（6–10条），后逐条修订；修订仅输出该条。
  - 变更：仅在文末“## 变更”追加一行摘要。
- constraints.md
  - 条目=名称(含类别)/简述/可能影响；≤6行/条；先初稿后逐条修订；仅改本条；文末记变更。
- decisions.md
  - 条目=日期/问题/选项/结论/理由/影响；≤10行/条；先初稿后逐条修订；文末记变更。
- risks.md
  - 条目=标题/概率/影响/缓解/触发条件；≤8行/条；先初稿后逐条修订；文末记变更。

变更记录约定（所有治理文件一致）
- 仅在文件末尾“## 变更”追加摘要条目，格式：
  - [vX.Y - YYYY-MM-DD] 范围/动机/变更/影响/验证
- 示例：
  - [v1.0 - 2025-08-13] 首版
  - [v1.1 - 2025-08-20] 范围：新增“支付凭证”术语；动机：契约字段对齐；变更：新增术语卡；影响：contracts.md 将补充 receiptId；验证：契约示例用例同步

拆分与归档
- 命名：glossary-order.md、glossary-payment.md；constraints-security.md；risks-ops.md 等。
- 目录页：可选在 0-governance/index.md 汇总子文件列表与一句话职责。
- 归档：历史冗长时新建 archive 文件，保留近两期活跃内容在主文件。

---

示例文件壳（可直接放入仓库）
- glossary.md
  # 统一术语表（卡片）
  - 术语：订单
    定义：客户提交的购买请求，覆盖创建/支付/履约/完成/取消生命周期
    正例：用户创建订单后进入“待支付”
    反例：库存预留记录不是订单
    易混词：交易单（清算用，不等价）

  - 术语：（空位）
    定义：
    正例：
    反例：
    易混词：

  ## 变更
  - [v1.0 - YYYY-MM-DD] 首版

- constraints.md
  # 显著约束（卡片）
  - 名称：API 鉴权最小权限（安全）
    简述：对外 API 使用 OAuth2，访问按 Scope 限制
    可能影响：4-delivery/contracts.md（需声明 scope 与拒绝策略）

  - 名称：（空位）
    简述：
    可能影响：

  ## 变更
  - [v1.0 - YYYY-MM-DD] 首版

- decisions.md
  # 关键决策（简条）
  - [YYYY-MM-DD] 问题：同步 RPC 还是事件驱动？
    选项：A 同步 RPC；B 事件驱动
    结论：B
    理由：削峰、解耦
    影响：2-tactical/*/events.md 新增事件；4-delivery/contracts.md 增事件契约

  ## 变更
  - [v1.0 - YYYY-MM-DD] 首版

- risks.md
  # 主要风险（卡片）
  - 标题：高峰期支付网关超时导致转化下降
    概率：中
    影响：高
    缓解：异步队列+重试≤2；排队票据反馈
    触发条件：QPS>2000 且 p95>250ms 连续15分钟

  ## 变更
  - [v1.0 - YYYY-MM-DD] 首版

---

使用建议
- 初稿期：依次生成四个文件的整文件初稿，形成统一术语/约束/决策/风险的“薄而全”认知面。
- 深化期：进入战术/交付文件前，先逐条修订治理文件中与之直接相关的条目，避免下游反复。
- 迭代期：新出现的重要术语、约束变化或决策调整，先回到治理文件补条目，再推进下游文件修订，保持“语言与约束先行”。
